---
# Supported options: 
#   sn-nature:       Style for submissions to Nature Portfolio journals
#   sn-basic:        Basic Springer Nature Reference Style/Chemistry Reference Style
#   sn-mathphys:     Math and Physical Sciences Reference Style
#   sn-aps:          American Physical Society (APS) Reference Style
#   sn-vancouver:    Vancouver Reference Style
#   sn-apa:          APA Reference Style 
#   sn-chicago:      Chicago-based Humanities Reference Style
#   default:         Default

classoptions: 
  - sn-basic      
  # - Numbered      # Optional: Use numbered references instead of namedate references (only for sn-nature, sn-basic, sn-vancouver, sn-chicago, sn-mathphys or sn-nature)
  # - referee       # Optional: Use double line spacing 
  # - lineno        # Optional: Add line numbers
  # - iicol         # Optional: Double column layour

title: Ordinal Pattern Analysis for Early Bearing Fault Detection and Classification in Rotating Machinery  
titlerunning: Lab Notebook

authors: 
  - prefix: 
    firstname: Rasika
    particle:  
    lastname: Dilhani
    suffix: 
    naturename: 
    degrees: MSc
    email: rasika.dilhani@vuw.ac.nz
    affiliation: [1]
    corresponding: TRUE
    equalcont: These authors contributed equally to this work.
    
  - firstname: Keila
    lastname: Author
    affiliation: [1,2]
    equalcont: These authors contributed equally to this work.
    
  - firstname: Alejandro
    lastname: Author
    affiliation: 1
    equalcont: These authors contributed equally to this work.


affiliations:
  - number: 1
    corresponding: TRUE
    info:
      orgdiv: School of Mathematics and Statistics
      orgname: Victoria University of Wellington
    address:
        street: 
        city: Wellington
        postcode: 6012
        state: 
        country: New Zealand
  - number: 2
    corresponding: TRUE
    info:
      orgname: Other Organisation
    
  
keywords:
  - key
  - dictionary
  - word
  
pacs: 
  jel:
    - "D8"
    - "H51"
  msc:
    - "35A01"
    - "65L10"

# Sample for unstructured abstract 
# abstract: |
#   The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. Authors are advised to check the author instructions for the journal they are submitting to for word limits and if structural elements like subheadings, citations, or equations are permitted.

# Sample for structured abstract
abstract: |
  **Purpose**: The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. The abstract must not include subheadings (unless expressly permitted in the journal's Instructions to Authors), equations or citations. As a guide the abstract should not exceed 200 words. Most journals do not set a hard limit however authors are advised to check the author instructions for the journal they are submitting to.
  
  **Methods:** The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. The abstract must not include subheadings (unless expressly permitted in the journal's Instructions to Authors), equations or citations. As a guide the abstract should not exceed 200 words. Most journals do not set a hard limit however authors are advised to check the author instructions for the journal they are submitting to.

  **Results:** The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. The abstract must not include subheadings (unless expressly permitted in the journal's Instructions to Authors), equations or citations. As a guide the abstract should not exceed 200 words. Most journals do not set a hard limit however authors are advised to check the author instructions for the journal they are submitting to.

  **Conclusion:** The abstract serves both as a general introduction to the topic and as a brief, non-technical summary of the main results and their implications. The abstract must not include subheadings (unless expressly permitted in the journal's Instructions to Authors), equations or citations. As a guide the abstract should not exceed 200 words. Most journals do not set a hard limit however authors are advised to check the author instructions for the journal they are submitting to.}

bibliography: ['BearingFaultDiagnosis.bib']
link-citations: True

header-includes: |
  %% Per the spinger doc, new theorem styles can be included using built in style, 
  %% but it seems the don't work so commented below
  %\theoremstyle{thmstyleone}%
  \newtheorem{theorem}{Theorem}%  meant for continuous numbers
  %%\newtheorem{theorem}{Theorem}[section]% meant for sectionwise numbers
  %% optional argument [theorem] produces theorem numbering sequence instead of independent numbers for Proposition
  \newtheorem{proposition}[theorem]{Proposition}%
  %%\newtheorem{proposition}{Proposition}% to get separate numbers for theorem and proposition etc.

  %% \theoremstyle{thmstyletwo}%
  \theoremstyle{remark}
  \newtheorem{example}{Example}%
  \newtheorem{remark}{Remark}%

  %% \theoremstyle{thmstylethree}%
  \theoremstyle{definition}
  \newtheorem{definition}{Definition}%

output: rticles::springer_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      out.extra = "")  # This forces knitr to label all figures.
```

# Introduction {#sec1}

Bearings are critical components in rotating machinery, yet their demanding operating conditions involving high loads and impacts often lead to various faults. These faults can result in significant downtime, costly maintenance, and even complete machine failure. Therefore, early and accurate detection and classification of bearing faults are essential for ensuring operational reliability and minimizing maintenance expenses. 

Traditional fault detection methods primarily rely on analyzing physical parameters and trends using techniques such as vibration analysis, thermal monitoring, and current signature analysis. While these methods have proven effective, they can be susceptible to noise and often require substantial computational resources. Ordinal pattern analysis has emerged as a promising alternative, offering a robust and computationally efficient approach for analyzing time series data. 

At its core, ordinal pattern analysis involves transforming continuous time series data into a sequence of ordinal patterns that represent the order relationships among data points within a given time window. This approach effectively captures the fundamental dynamics of the signal in a manner that is inherently robust to noise and distortions. By analyzing these patterns, it becomes possible to identify subtle changes in system behavior that may indicate the presence of a fault. 

This study investigates the application of ordinal pattern analysis for early detection and classification of bearing faults, focusing on common fault types such as ball, outer race, and inner race defects. Using a publicly available dataset from the Case Western Reserve University Bearing Data Center, we will demonstrate the effectiveness of ordinal patterns in distinguishing between healthy and faulty bearing conditions. 

Our research will explore the advantages of ordinal pattern analysis in detecting changes in system dynamics associated with faults. By identifying alterations in the frequency and recurrence of specific temporal patterns, this technique can reveal subtle indicators of developing faults. Furthermore, unlike some traditional methods limited to linear systems, ordinal pattern analysis can effectively detect faults in complex, non-linear systems, broadening its applicability. 

This study will also compare the performance of ordinal pattern analysis with traditional fault detection techniques, evaluating metrics such as accuracy, sensitivity, and computational efficiency. While traditional methods often rely on specialized sensors and data acquisition systems, ordinal pattern analysis can potentially achieve comparable results using simpler time series data, highlighting its potential for wider adoption. Additionally, we will investigate the sensitivity of ordinal pattern analysis to subtle changes in system dynamics, particularly within complex systems, where its strengths may be most pronounced. 

We aim to establish ordinal pattern analysis as a viable and advantageous tool for bearing fault diagnosis, contributing to the advancement of predictive maintenance technologies and promoting more efficient and reliable operation of rotating machinery.

# Ordinal Patterns {#sec2}

# Literature Review {#sec3}

@WOS:000312724900101 introduce an enhanced approach to detect bearing faults through the utilization of high-frequency resonance, resulting in enhanced precision and dependability in diagnosing faults within mechanical systems. The investigation illustrates that this refined methodology adeptly recognizes initial bearing abnormalities, representing a noteworthy progression compared to conventional diagnostic techniques. The article by [@WOS:000301688000008] presents a fresh technique for fault identification which employs an adaptive rank-order morphological filter to categorize patterns in one-dimensional signals. This strategy amplifies the precision and resilience of fault diagnosis by proficiently sifting through and pinpointing signal irregularities. Furthermore, the scholars in the publication from [@WOS:000303039300034] propose an approach for early fault detection in machinery by scrutinizing truncated vibration signals using Shannon wavelet spectrum analysis. This method heightens the detection of emerging faults, thereby enhancing the prognostic maintenance of equipment.

@WOS:000345844100102 discuss a prototype FPGA implementation that uses machine learning to convert analog signals into concise feature representations. It employs an event-based methodology to enhance the efficiency and accuracy of signal processing across various applications. The [@WOS:000396580800080] study discusses the utilization of a dedicated hierarchy of neural networks for evaluating bearing degradation, thereby enhancing the precision and dependability of diagnosing the state and remaining operational life of bearings in machinery. By amalgamating multifractal detrended fluctuation analysis with the Mahalanobis distance criterion [@WOS:000320835800016], the research in the publication enhances the fault diagnosis of rolling bearings, leading to improved diagnostic accuracy and offering efficient, validated approaches for early fault detection in industrial settings.

An additional intriguing research study detailed in the publication [@WOS:000360994300029] introduces a diagnostic technique for rolling element bearings grounded in the concept of active perception. This method revolves around examining the dynamic interactions between the bearing and its surroundings. Noteworthy discoveries include the capability of the approach to precisely evaluate the bearing's condition by integrating perceptual cues and responses, thereby enhancing fault detection and predictive maintenance strategies. The study described in [@WOS:000343577703075] presents a fault diagnosis approach for rolling element bearings that makes use of Empirical Mode Decomposition (EMD) in conjunction with Discrete Fourier Domain Analysis (DFDA). This technique proficiently isolates and scrutinizes fault-related characteristics in vibration signals, resulting in enhanced accuracy and dependability in the diagnosis of bearing conditions. The utilization of a signal-based triangular structuring element for mathematical morphological analysis, along with the application of this method to boost fault diagnosis in rolling element bearings through the effective processing and interpretation of vibration signal features, was deliberated in the publication [@WOS:000334316700001]. Furthermore, a hybrid CEEMD-EMD strategy for fault detection in rolling bearings, which merges Complete Ensemble Empirical Mode Decomposition with Noise (CEEMD) and traditional Empirical Mode Decomposition (EMD) to enhance the precision of vibration signal analysis and augment fault detection capabilities, has been enhanced in the manuscript [@WOS:000412752200052].

The authors of the paper [@WOS:000335959500009] propose a methodology for bearing fault detection that utilizes compressive measurements of vibration signals to efficiently detect faults, thereby enhancing diagnostic accuracy while reducing the data processing load. A unique technique for feature extraction, based on the crossover characteristics of nonlinear data, is applied to enhance fault diagnosis in rotary machinery by effectively identifying critical patterns in complex signal data as explored in [@WOS:000338603900013]. Research studies indicate that Self-Organizing Maps (SOMs) are successful in diagnosing motor bearing faults through the classification of complex vibration data, while approaches based on fast nonlocal means and envelope spectra contribute to improving fault diagnosis accuracy. Moreover, a low-dimensional compressed measurement strategy boosts fault detection efficiency, and a Bayesian inference technique guided by a smoothness index enables precise identification of various bearing faults by analyzing anti-symmetric real Laplace wavelet parameters [@WOS:000380543400119, @WOS:000348309400067, @WOS:000354607100016, @WOS:000350998800016]. Recent scholarly investigations have concentrated on advanced methodologies for bearing fault diagnosis using vibration signals. Statistical locally linear embedding has been suggested as a potent technique for dimensionality reduction and feature extraction, surpassing conventional methods like PCA and LDA [@WOS:000361788200068]. The combination of wavelet packet decomposition with multi-scale permutation entropy exhibits potential in accurately detecting bearing faults utilizing hidden Markov models [@WOS:000362513400031]. Results demonstrate that this approach significantly improves fault detection accuracy compared to traditional methods, achieving higher precision in identifying fault types and their severity. Integrating wavelet packet decomposition with multi-scale permutation entropy enhances the reliability of fault diagnosis systems, making it a valuable technique for predictive maintenance in industrial applications. 

The authors of [@WOS:000365686400021] introduce a new feature extraction technique called Window Marginal Spectrum Clustering (WMSC) for diagnosing faults in roller element bearings (REBs). This method utilizes the Hilbert-Huang Transform (HHT) and Support Vector Machines (SVM) to improve classification accuracy and robustness against Gaussian white noise. Experimental results with datasets from the Bearing Data Center of Case Western Reserve University (CWRU) demonstrate that WMSC outperforms conventional methods. Additionally, [@WOS:000366534900022] presents "The Diagnostic Line," a novel criterion for monitoring the condition of rotating machinery. This approach aims to enhance the accuracy and reliability of machinery health diagnosis. A comparative analysis, using data from Case Western Reserve University, was conducted to evaluate various diagnostic techniques and establish a standard reference for bearing fault diagnosis [@WOS:000357230900007].

The current study is built upon this investigation, incorporating the same dataset for further examination employing a novel time series model. Wavelet analysis, renowned for its multiresolution capabilities and superior time-frequency domain attributes, is augmented by the wavelet total variation (WATV) technique, which merges wavelet-domain sparsity with total variation regularization; this manuscript presents an enhanced wavelet total variation (IWATV) denoising approach utilizing local variance analysis on wavelet coefficients to estimate noise variance, illustrating enhanced noise reduction and fault diagnosis effectiveness compared to conventional methodologies through numerical simulations and real-world failure data. Furthermore, an innovative two-step strategy leveraging permutation entropy for fault detection, along with wavelet packet transform, envelope analysis, and neuro-fuzzy classification for fault isolation, has been devised, demonstrating improved diagnostic proficiency in contrast to existing techniques [@WOS:000385104500001],[@RAJABI:2022117754]. These progressions contribute to more precise and effective bearing fault diagnosis in industrial rotating machinery. An adapted kernel marginal Fisher analysis (MKMFA) technique for feature extraction and dimensionality reduction to enhance bearing fault diagnosis accuracy is elaborated in a study; by extracting critical low-dimensional features and employing a K-nearest neighbor classifier, it exhibits superior performance in comparison to alternative approaches when utilized for identifying diverse bearing faults [@WOS:000392016300001].

Signal analysis of vibrations is a significantly efficient approach for diagnosing mechanical faults. However, the identification of defects in their early stages poses a challenge due to the presence of noise from components [@WOS:000369301600001, @WOS:000367992900001]. This study introduces a fresh methodology that merges time domain analysis with adaptive fuzzy C-means clustering. It utilizes nine standard time domain parameters to construct characteristic vectors and enhances clustering by optimizing with five specific parameters (such as variance, RMS, kurtosis, skewness, and crest factor). The research showcases the capability of sensitive fault identification, even for minor faults. Additionally, it devises an innovative fault diagnosis technique for rolling bearings by integrating Multifractal Detrended Fluctuation Analysis (MFDFA) and Alpha Stable Distribution (ASD) features. This method incorporates Kernel Principal Component Analysis (KPCA) for reducing dimensionality and fusing features. Moreover, it applies the Least Squares Support Vector Machine (LSSVM) with Particle Swarm Optimization (PSO) for classification, revealing higher accuracy and efficacy based on bench test data when compared to approaches using single features.

The paper by [@WOS:000366765500038] introduces an innovative technique for assessing machinery damage, utilizing manifold learning principles to compute subspace distances. This method enhances the accuracy and responsiveness of damage evaluation by applying advanced dimensionality reduction techniques. The research by [@WOS:000379556300014] presents the utilization of Multivariate Empirical Mode Decomposition (MEMD) in diagnosing rolling bearings' faults. It demonstrates the effectiveness of this method in improving fault detection by thoroughly analyzing complex, multidimensional signal data. The manuscript proposes a methodology for diagnosing faults in rolling element bearings by integrating Multifractal Theory and Gray Relation Theory. This integration is designed to improve the precision and reliability of fault detection and analysis, ultimately enhancing diagnostic results[@WOS:000391229300006]. The study introduces a new approach for examining vibration signals in rolling bearings, which combines dual-entropy, Holder coefficient, and Gray Relation Theory. This integration aims to improve the efficiency of fault detection and analysis by leveraging these methods to achieve higher levels of precision and reliability in diagnostics[@WOS:000426819400027].

The paper of [@WOS:000398818700108] discusses the Shock Pulse Index (SPI) and its application in diagnosing faults in rolling element bearings, highlighting SPI's effectiveness in detecting and analyzing bearing condition and performance issues; the results demonstrate that SPI provides accurate fault detection and is a valuable tool for monitoring and diagnosing bearing health. The paper explores fault diagnosis for rolling bearings under variable conditions using visual cognition techniques, focusing on how visual analysis can enhance fault detection and diagnosis accuracy; results indicate that visual cognition methods significantly improve the ability to identify and assess bearing faults in changing operational environments[@WOS:000404415000016]. The paper [@WOS:000401109400020] introduces sparse discriminant manifold projections for bearing fault diagnosis, leveraging advanced dimensionality reduction techniques to enhance fault detection and classification accuracy; results show that this method effectively identifies bearing faults by capturing essential discriminative features while reducing noise and irrelevant data. The paper [@WOS:000419006900041] presents a fault detection method for rolling bearings' vibration signals using the Symplectic Entropy method, which analyzes the complexity and patterns of vibration data to improve fault identification accuracy; results demonstrate that this approach effectively detects faults by providing a robust measure of signal irregularities and anomalies.

A method for extracting incipient fault features in rolling bearings using an autocorrelation function impulse harmonic-to-noise ratio index, combined with Singular Value Decomposition (SVD) and the Teager Energy Operator; results show that this approach effectively identifies early-stage faults by enhancing the detection of subtle signal anomalies amidst noise [@WOS:000416794600016]. The authors of [@WOS:000484465800028] presents a bearing fault diagnosis method that combines autoencoders with Particle Swarm Optimization (PSO) and Support Vector Machines (SVM); this approach leverages autoencoders for feature extraction and dimensionality reduction, while PSO optimizes the SVM parameters, resulting in improved diagnostic accuracy and robustness in identifying bearing faults. The paper introduces an optimized resolution coefficient algorithm for the Gray Relation Classifier, aiming to enhance classification accuracy by improving the algorithm's ability to distinguish between different classes through refined resolution coefficients, leading to more precise fault diagnosis and analysis [@WOS:000477760600037]. The authors of [@WOS:000477760600061] proposes a signal subtle feature extraction algorithm using an improved fractal box-counting dimension method, which enhances the detection of fine-grained features in signals by refining the fractal dimension calculation, resulting in better identification and analysis of subtle signal patterns.

A novel rolling bearing fault detection method based on Empirical Wavelet Transform (EWT), which effectively decomposes vibration signals into components that highlight fault-related features, improving detection accuracy and robustness in identifying bearing faults [@WOS:000467079500501]. A bearing fault detection method in the article [@WOS:000459864800144] that combines Empirical Mode Decomposition (EMD) with Random Forest, which effectively analyzes vibration signals under varying operational conditions by decomposing them into intrinsic mode functions and classifying fault patterns, resulting in enhanced detection accuracy and reliability. The paper [@WOS:000458657500187] critically examines the significance of feature extraction and selection in diagnosing bearing defects, emphasizing that effective feature extraction and selection are crucial for improving diagnostic accuracy and reliability by identifying the most relevant characteristics from vibration signals.

The study investigates an online health status estimation technique for rolling bearings based on vibration signals, with a focus on real-time monitoring and analysis for evaluating bearing condition. It is shown in the research that this method effectively assesses health status through continuous evaluation of vibration data to identify and predict potential faults [@WOS:000452922000015]. An automatic classification approach for bearing faults is presented in the paper, utilizing deep learning methods that employ neural networks to examine and categorize fault patterns present in vibration signals [@WOS:000453413600001]. This leads to enhanced accuracy and efficiency in the detection and diagnosis of bearing faults. The research paper [@WOS:000452819600235] introduces a method for early fault diagnosis in bearings using Empirical Wavelet Transform (EWT) in conjunction with energy entropy. By analyzing vibration signals with detailed frequency decomposition and measuring the distribution of signal energy, this method improves the identification accuracy of early faults. Another study [@WOS:000450745100001, @WOS:000449334500118]  introduces a technique for detecting faults in rolling element bearings that involves segmenting vibration signals and applying wavelet analysis and deep neural networks. This method improves fault detection by segmenting the signal into meaningful parts for better accuracy, utilizing wavelet transforms for extracting features, and employing deep neural networks for clustering and categorizing, resulting in more precise identification of bearing faults.

The present study [@WOS:000440977000032]  introduces a technique for extracting bearing fault features using autoregressive coefficients, Linear Discriminant Analysis (LDA), and Support Vector Machines (SVM) in varying operational conditions. These methods are combined to improve fault detection by accurately identifying and categorizing fault features even amidst changing operational settings. A unique diagnostic approach for rolling element bearings is proposed, which integrates Noise-Assisted Multivariate Empirical Mode Decomposition (MEMD) with a Functional Neural Fuzzy Network [@WOS:000434717400001]. This integration utilizes MEMD to extract features effectively and the neural fuzzy network for precise fault classification, resulting in enhanced diagnostic precision and reliability. Another study [@WOS:000426284100001]  presents a fault diagnosis method for rolling bearings that utilizes Modified Local Fisher Discriminant Analysis (LFDA) and Empirical Mode Decomposition (EMD) along with sensitive feature selection . The objective is to enhance fault detection by extracting and examining critical features from vibration signals with improved accuracy and discrimination.  [@WOS:000539546400083] This article details an initial fault diagnosis technique for rolling bearings that merges Empirical Wavelet Transform (EWT) with Spectral Kurtosis. The focus is on detecting initial faults through refined frequency analysis with EWT and highlighting abnormal signal features using Spectral Kurtosis, leading to improved early fault detection and diagnostic accuracy. Another study [@HAKIM:2023101945] introduces an enhanced similarity-based modeling approach for classifying failures in rotating machines. By utilizing advanced similarity measures to better match failure patterns and improve diagnostic precision, the accuracy and effectiveness of fault classification are significantly enhanced. Results indicate that this approach surpasses traditional classification techniques, achieving higher accuracy and reliability in failure detection. A comprehensive review is provided on fault diagnosis methods for rolling bearings that employ deep learning and transfer learning. The review offers a detailed classification, overview, and application of these techniques, while also addressing current challenges, weaknesses, and offering suggestions for future research. It is emphasized that deep learning and transfer learning methods have substantially improved fault diagnosis accuracy and robustness. However, challenges such as the necessity for more diverse datasets and the difficulty of model generalization across different operational conditions persist. Addressing these challenges is crucial to further enhancing the effectiveness and applicability of these advanced diagnostic methods.
 


# Results {#sec4}

Sample body text. 
Sample body text. 
Sample body text. 
Sample body text.
Sample body text.
Sample body text.
Sample body text. 
Sample body text.

# This is an example for first level head---section head {#sec5}

## This is an example for second level head---subsection head {#subsec2}

### This is an example for third level head---subsubsection head {#subsubsec2}

Sample body text. 
Sample body text. 
Sample body text.
Sample body text.
Sample body text.
Sample body text. 
Sample body text.

# Equations {#sec6}

Equations in \LaTeX\ can either be inline or on-a-line by itself ("display equations"). For
inline equations use the `$...$` commands. E.g.: The equation
$H\psi = E \psi$ is written via the command `$H \psi = E \psi$`.

For display equations (with auto generated equation numbers)
one can use the equation or align environments:

\begin{equation}
\|\tilde{X}(k)\|^2 \leq\frac{\sum\limits_{i=1}^{p}\left\|\tilde{Y}_i(k)\right\|^2+\sum\limits_{j=1}^{q}\left\|\tilde{Z}_j(k)\right\|^2 }{p+q}.\label{eq1}
\end{equation}


where,
\begin{align}
D_\mu &=  \partial_\mu - ig \frac{\lambda^a}{2} A^a_\mu \nonumber \\
F^a_{\mu\nu} &= \partial_\mu A^a_\nu - \partial_\nu A^a_\mu + g f^{abc} A^b_\mu A^a_\nu \label{eq2}
\end{align}

Notice the use of `\nonumber` in the align environment at the end
of each line, except the last, so as not to produce equation numbers on
lines where no equation numbers are required. The `\label{}` command
should only be used at the last line of an align environment where
`\nonumber` is not used.

\begin{equation}
Y_\infty = \left( \frac{m}{\textrm{GeV}} \right)^{-3}
    \left[ 1 + \frac{3 \ln(m/\textrm{GeV})}{15}
    + \frac{\ln(c_2/5)}{15} \right]
\end{equation}

The class file also supports the use of `\mathbb{}`, `\mathscr{}` and
`\mathcal{}` commands. As such `\mathbb{R}`, `\mathscr{R}`
and `\mathcal{R}` produces $\mathbb{R}$, $\mathscr{R}$ and $\mathcal{R}$
respectively (refer Subsubsection\ \ref{subsubsec2}).

# Tables {#sec7}

Tables can be inserted via the normal `knitr::kable()` function or other table-generating packages. 

```{r tab1}
knitr::kable(head(pressure), 
             format = "latex", 
             caption = "Caption text")
```

Tables can also be inserted via the normal table and tabular environment. To put
footnotes inside tables you should use `\footnotetext[]{...}` tag.
The footnote appears just below the table itself (refer Tables~\ref{tab1} and \ref{tab2}).
For the corresponding footnotemark use `\footnotemark[...]`

\begin{table}[h]
\caption{Caption text}\label{tab1}%
\begin{tabular}{@{}llll@{}}
\toprule
Column 1 & Column 2  & Column 3 & Column 4\\
\midrule
row 1    & data 1   & data 2  & data 3  \\
row 2    & data 4   & data 5\footnotemark[1]  & data 6  \\
row 3    & data 7   & data 8  & data 9\footnotemark[2]  \\
\botrule
\end{tabular}
\footnotetext{Source: This is an example of table footnote. This is an example of table footnote.}
\footnotetext[1]{Example for a first table footnote. This is an example of table footnote.}
\footnotetext[2]{Example for a second table footnote. This is an example of table footnote.}
\end{table}

\noindent
The input format for the above table is as follows:


```
\begin{table}[<placement-specifier>]
\caption{<table-caption>}\label{<table-label>}%
\begin{tabular}{@{}llll@{}}
\toprule
Column 1 & Column 2 & Column 3 & Column 4\\
\midrule
row 1 & data 1 & data 2	 & data 3 \\
row 2 & data 4 & data 5\footnotemark[1] & data 6 \\
row 3 & data 7 & data 8	 & data 9\footnotemark[2]\\
\botrule
\end{tabular}
\footnotetext{Source: This is an example of table footnote.
This is an example of table footnote.}
\footnotetext[1]{Example for a first table footnote.
This is an example of table footnote.}
\footnotetext[2]{Example for a second table footnote.
This is an example of table footnote.}
\end{table}
```

\begin{table}[h]
\caption{Example of a lengthy table which is set to full textwidth}\label{tab2}
\begin{tabular*}{\textwidth}{@{\extracolsep\fill}lcccccc}
\toprule%
& \multicolumn{3}{@{}c@{}}{Element 1\footnotemark[1]} & \multicolumn{3}{@{}c@{}}{Element 2\footnotemark[2]} \\\cmidrule{2-4}\cmidrule{5-7}%
Project & Energy & $\sigma_{calc}$ & $\sigma_{expt}$ & Energy & $\sigma_{calc}$ & $\sigma_{expt}$ \\
\midrule
Element 3  & 990 A & 1168 & $1547\pm12$ & 780 A & 1166 & $1239\pm100$\\
Element 4  & 500 A & 961  & $922\pm10$  & 900 A & 1268 & $1092\pm40$\\
\botrule
\end{tabular*}
\footnotetext{Note: This is an example of table footnote. This is an example of table footnote this is an example of table footnote this is an example of~table footnote this is an example of table footnote.}
\footnotetext[1]{Example for a first table footnote.}
\footnotetext[2]{Example for a second table footnote.}
\end{table}

\vfill\eject

In case of double column layout, tables which do not fit in single column width should be set to full text width. 
For this, you need to use `\begin{table*}` `...` `\end{table*}` instead of `\begin{table}` `...` `\end{table}` environment. Lengthy tables which do not fit in textwidth should be set as rotated table. For this, you need to use `\begin{sidewaystable}` `...` `\end{sidewaystable}` instead of `\begin{table*}` `...` `\end{table*}` environment. This environment puts tables rotated to single column width. For tables rotated to double column width, use `\begin{sidewaystable*}` `...` `\end{sidewaystable*}`.

\begin{sidewaystable}
\caption{Tables which are too long to fit, should be written using the "sidewaystable" environment as shown here}\label{tab3}
\begin{tabular*}{\textheight}{@{\extracolsep\fill}lcccccc}
\toprule%
& \multicolumn{3}{@{}c@{}}{Element 1\footnotemark[1]}& \multicolumn{3}{@{}c@{}}{Element\footnotemark[2]} \\\cmidrule{2-4}\cmidrule{5-7}%
Projectile & Energy	& $\sigma_{calc}$ & $\sigma_{expt}$ & Energy & $\sigma_{calc}$ & $\sigma_{expt}$ \\
\midrule
Element 3 & 990 A & 1168 & $1547\pm12$ & 780 A & 1166 & $1239\pm100$ \\
Element 4 & 500 A & 961  & $922\pm10$  & 900 A & 1268 & $1092\pm40$ \\
Element 5 & 990 A & 1168 & $1547\pm12$ & 780 A & 1166 & $1239\pm100$ \\
Element 6 & 500 A & 961  & $922\pm10$  & 900 A & 1268 & $1092\pm40$ \\
\botrule
\end{tabular*}
\footnotetext{Note: This is an example of table footnote this is an example of table footnote this is an example of table footnote this is an example of~table footnote this is an example of table footnote.}
\footnotetext[1]{This is an example of table footnote.}
\end{sidewaystable}

# Figures {#sec6}

As per the \LaTeX\ standards you need to use eps images for \LaTeX\ compilation and `pdf/jpg/png` images for `PDFLaTeX` compilation. 
Use the `dev` knitr option to use the approrpate format. 
This is one of the major difference between \LaTeX\ and `PDFLaTeX`.
Each image should be from a single input .eps/vector image file. 
Avoid using subfigures.
The command for inserting images for \LaTeX\ and `PDFLaTeX` can be generalized. 
The package used to insert images in `LaTeX/PDFLaTeX` is the graphicx package. 
Figures can be inserted via the normal figure environment as shown in the below example:

```{r fig1, fig.cap = "This is an example of a caption", fig.width = 5}
plot(pressure)
```

# Algorithms, Program codes and Listings {#sec7}

Packages `algorithm`, `algorithmicx` and `algpseudocode` are used for setting algorithms in \LaTeX\ using the format:

```
\begin{algorithm}
\caption{<alg-caption>}\label{<alg-label>}
\begin{algorithmic}[1]
. . .
\end{algorithmic}
\end{algorithm}
```

You may refer above listed package documentations for more details before setting `algorithm` environment. For program codes, the "program" package is required and the command to be used is `\begin{program}` `...` `\end{program}`. A fast exponentiation procedure:

Similarly, for `listings`, use the `listings` package. `\begin{lstlisting}` `...` `\end{lstlisting}` is used to set environments similar to `verbatim` environment. Refer to the `lstlisting` package documentation for more details.

A fast exponentiation procedure:

```{=latex}
\lstset{texcl=true,basicstyle=\small\sf,commentstyle=\small\rm,mathescape=true,escapeinside={(*}{*)}}
\begin{lstlisting}
begin
  for $i:=1$ to $10$ step $1$ do
      expt($2,i$);  
      newline() od                (*\textrm{Comments will be set flush to the right margin}*)
where
proc expt($x,n$) $\equiv$
  $z:=1$;
  do if $n=0$ then exit fi;
     do if odd($n$) then exit fi;                 
        comment: (*\textrm{This is a comment statement;}*)
        $n:=n/2$; $x:=x*x$ od;
     { $n>0$ };
     $n:=n-1$; $z:=z*x$ od;
  print($z$). 
end
\end{lstlisting}
```

```{=latex}
\begin{algorithm}
\caption{Calculate $y = x^n$}\label{algo1}
\begin{algorithmic}[1]
\Require $n \geq 0 \vee x \neq 0$
\Ensure $y = x^n$ 
\State $y \Leftarrow 1$
\If{$n < 0$}\label{algln2}
        \State $X \Leftarrow 1 / x$
        \State $N \Leftarrow -n$
\Else
        \State $X \Leftarrow x$
        \State $N \Leftarrow n$
\EndIf
\While{$N \neq 0$}
        \If{$N$ is even}
            \State $X \Leftarrow X \times X$
            \State $N \Leftarrow N / 2$
        \Else[$N$ is odd]
            \State $y \Leftarrow y \times X$
            \State $N \Leftarrow N - 1$
        \EndIf
\EndWhile
\end{algorithmic}
\end{algorithm}
```

:::: {.minipage latex="{\hsize}"}
\lstset{frame=single,framexleftmargin=-1pt,framexrightmargin=-17pt,framesep=12pt,linewidth=0.98\textwidth,language=pascal}
<!-- Set your language (you can change the language for each code-block optionally) -->
<!-- Start your code-block -->
::: {.lstlisting latex=true}
for i:=maxint to 0 do
begin
{ do nothing }
end;
Write('Case insensitive ');
Write('Pascal keywords.');
:::
::::

# Cross referencing {#sec8}

Figures and tables are labeled with a prefix (fig or tab, respectively) plus the chunk label. 
Other environments such as equation and align can be labelled via the `\label{#label}` command inside or just below the `\caption{}` command.
You can then use the label for cross-reference. As an example, consider
the chunk label declared for Figure\ \ref{fig:fig1} which is
fig1. 
To cross-reference it, use the command
`Figure \ref{fig:fig1}`, for which it comes up as
"Figure\ \ref{fig:fig1}".

To reference line numbers in an algorithm, consider the label declared for the line number 2 of Algorithm\ \ref{algo1} is `\label{algln2}`. To cross-reference it, use the command `\ref{algln2}` for which it comes up as line\ \ref{algln2} of Algorithm\ \ref{algo1}.

## Details on reference citations {#subsec7}

For citations of references, use\ @bib1 or [@bib2]. 

# Examples for theorem like environments {#sec10}

The documentclass for springer `sn-jnl.cls` contains 3 styling that you can use to set new default for theorems and proofs type 

`thmstyleone`

: Numbered, theorem head in bold font and theorem text in italic style

`thmstyletwo`

: Numbered, theorem head in roman font and theorem text in italic style

`thmstylethree`

: Numbered, theorem head in bold font and theorem text in roman style 

For mathematics journals, theorem styles can be included as shown in the following examples.

::: {.theorem latex=true}
Example theorem text. Example theorem text. Example theorem text. Example theorem text. Example theorem text.
Example theorem text. Example theorem text. Example theorem text. Example theorem text. Example theorem text.
Example theorem text.
:::

To add labels and subheadings, use LaTeX notation  

::: {.theorem latex="[Theorem subhead]\label{thm1}"}
Example theorem text. Example theorem text. Example theorem text. Example theorem text. Example theorem text.
Example theorem text. Example theorem text. Example theorem text. Example theorem text. Example theorem text.
Example theorem text.
:::

Other environments are proposition, example, remark, definition, proof and quote  

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.  

::: {.proposition latex=true}
Example proposition text. Example proposition text. Example proposition text. Example proposition text. Example proposition text. 
Example proposition text. Example proposition text. Example proposition text. Example proposition text. Example proposition text. 
:::

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.

::: {.example latex=true}
Phasellus adipiscing semper elit. Proin fermentum massa
ac quam. Sed diam turpis, molestie vitae, placerat a, molestie nec, leo. Maecenas lacinia. Nam ipsum ligula, eleifend
at, accumsan nec, suscipit a, ipsum. Morbi blandit ligula feugiat magna. Nunc eleifend consequat lorem. 
:::

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.

::: {.remark latex=true}
Phasellus adipiscing semper elit. Proin fermentum massa
ac quam. Sed diam turpis, molestie vitae, placerat a, molestie nec, leo. Maecenas lacinia. Nam ipsum ligula, eleifend
at, accumsan nec, suscipit a, ipsum. Morbi blandit ligula feugiat magna. Nunc eleifend consequat lorem. 
:::

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.

::: {.definition latex="[Definition sub head]"}
Example definition text. Example definition text. Example definition text. Example definition text. Example definition text. Example definition text. Example definition text. Example definition text. 
:::

Additionally a predefined "proof" environment is available. This prints a "Proof" head in italic font style and the "body text" in roman font style with an open square at the end of each proof environment. 

::: {.proof latex=true}
Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. Example for proof text. 
:::

Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text. Sample body text.

# Methods {#sec11}

Topical subheadings are allowed. Authors must ensure that their Methods section includes adequate experimental and characterization data necessary for others in the field to reproduce their work. Authors are encouraged to include RIIDs where appropriate.

**Ethical approval declarations** (only required where applicable) Any article reporting experiment/s carried out on (i)~live vertebrate (or higher invertebrates), (ii)~humans or (iii)~human samples must include an unambiguous statement within the methods section that meets the following requirements:

1. Approval: a statement which confirms that all experimental protocols were approved by a named institutional and/or licensing committee. Please identify the approving body in the methods section

2. Accordance: a statement explicitly saying that the methods were carried out in accordance with the relevant guidelines and regulations

3. Informed consent (for experiments involving humans or human tissue samples): include a statement confirming that informed consent was obtained from all participants and/or their legal guardian/s


If your manuscript includes potentially identifying patient/participant information, or if it describes human transplantation research, or if it reports results of a clinical trial then  additional information will be required. Please visit (<https://www.nature.com/nature-research/editorial-policies>) for Nature Portfolio journals, (<https://www.springer.com/gp/authors-editors/journal-author/journal-author-helpdesk/publishing-ethics/14214>) for Springer Nature journals, or (<https://www.biomedcentral.com/getpublished/editorial-policies\#ethics+and+consent>) for BMC.

# Discussion {#sec12}

Discussions should be brief and focused. In some disciplines use of Discussion or 'Conclusion' is interchangeable. It is not mandatory to use both. Some journals prefer a section 'Results and Discussion' followed by a section 'Conclusion'. Please refer to Journal-level guidance for any specific requirements.

# Conclusion {#sec13}

Conclusions may be used to restate your hypothesis or research question, restate your major findings, explain the relevance and the added value of your work, highlight any limitations of your study, describe future directions for research and recommendations.

In some disciplines use of Discussion or 'Conclusion' is interchangeable. It is not mandatory to use both. Please refer to Journal-level guidance for any specific requirements.

\backmatter

\bmhead{Supplementary information}

If your article has accompanying supplementary file/s please state so here.

Authors reporting data from electrophoretic gels and blots should supply the full unprocessed scans for key as part of their Supplementary information. This may be requested by the editorial team/s if it is missing.

Please refer to Journal-level guidance for any specific requirements.

\bmhead{Acknowledgments}

Acknowledgments are not compulsory. Where included they should be brief. Grant or contribution numbers may be acknowledged.

Please refer to Journal-level guidance for any specific requirements.

# Declarations {.unnumbered}

Some journals require declarations to be submitted in a standardised format. Please check the Instructions for Authors of the journal to which you are submitting to see if you need to complete this section. If yes, your manuscript must contain the following sections under the heading `Declarations':

* Funding
* Conflict of interest/Competing interests (check journal-specific guidelines for which heading to use)
* Ethics approval
* Consent to participate
* Consent for publication
* Availability of data and materials
* Code availability
* Authors' contributions

\noindent
If any of the sections are not relevant to your manuscript, please include the heading and write `Not applicable' for that section.


::: {.flushleft latex=true}
Editorial Policies for:

\noindent
Springer journals and proceedings: <https://www.springer.com/gp/editorial-policies>

\noindent
Nature Portfolio journals: <https://www.nature.com/nature-research/editorial-policies>

\noindent
\textit{Scientific Reports}: <https://www.nature.com/srep/journal-policies/editorial-policies>

\noindent
BMC journals: <https://www.biomedcentral.com/getpublished/editorial-policies>
:::


::: {.appendices latex=true}

# Section title of first appendix {#secA1}

An appendix contains supplementary information that is not an essential part of the text itself but which may be helpful in providing a more comprehensive understanding of the research problem or it is information that is too cumbersome to be included in the body of the paper.

For submissions to Nature Portfolio Journals please use the heading "Extended Data".  

:::
